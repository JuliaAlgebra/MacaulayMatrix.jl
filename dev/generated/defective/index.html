<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Defective univariate example · MacaulayMatrix</title><meta name="title" content="Defective univariate example · MacaulayMatrix"/><meta property="og:title" content="Defective univariate example · MacaulayMatrix"/><meta property="twitter:title" content="Defective univariate example · MacaulayMatrix"/><meta name="description" content="Documentation for MacaulayMatrix."/><meta property="og:description" content="Documentation for MacaulayMatrix."/><meta property="twitter:description" content="Documentation for MacaulayMatrix."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MacaulayMatrix</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Index</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Defective univariate example</a></li><li><a class="tocitem" href="../dreesen10/">Positive dimensional roots at infinity</a></li><li><a class="tocitem" href="../dreesen2/">Getting rid of root at infinity</a></li><li><a class="tocitem" href="../infinity/">Degree gap versus staircase gap</a></li><li><a class="tocitem" href="../univariate/">Univariate</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Defective univariate example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Defective univariate example</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Defective-univariate-example"><a class="docs-heading-anchor" href="#Defective-univariate-example">Defective univariate example</a><a id="Defective-univariate-example-1"></a><a class="docs-heading-anchor-permalink" href="#Defective-univariate-example" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaAlgebra/MacaulayMatrix.jl/gh-pages?filepath=dev/generated/defective.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaAlgebra/MacaulayMatrix.jl/blob/gh-pages/dev/generated/defective.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><pre><code class="language-julia hljs">using LinearAlgebra
using TypedPolynomials
using MacaulayMatrix
using MultivariateMoments
import Clarabel</code></pre><p>Consider the following system with a root of multiplicity 4:</p><pre><code class="language-julia hljs">@polyvar x
system = [(x - 4)^4]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{MultivariatePolynomials.VectorPolynomial{Int64, MultivariatePolynomials.Term{Int64, TypedPolynomials.Monomial{(x,), 1}}}}:
 256 - 256x + 96x² - 16x³ + x⁴</code></pre><p>The Macaulay framework finds the root with degree 4:</p><pre><code class="language-julia hljs">solve_system(system, column_maxdegree = 4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Vector{Float64}}:
 [4.00000000000001]</code></pre><p>Let&#39;s find the max rank PSD hankel from from the degree 4 Macaulay nullspace:</p><pre><code class="language-julia hljs">ν = moment_matrix(system, Clarabel.Optimizer, 4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Nullspace of dimensions (5, 4) computed from Macaulay matrix of dimension (1, 5) in 3.792e-5 seconds.
-------------------------------------------------------------
           Clarabel.jl v0.9.0  -  Clever Acronym
                   (c) Paul Goulart
                University of Oxford, 2022
-------------------------------------------------------------

problem:
  variables     = 4
  constraints   = 7
  nnz(P)        = 0
  nnz(A)        = 28
  cones (total) = 2
    : Zero        = 1,  numel = 1
    : PSDTriangle = 1,  numel = 6

settings:
  linear algebra: direct / qdldl, precision: Float64
  max iter = 200, time limit = Inf,  max step = 0.990
  tol_feas = 1.0e-08, tol_gap_abs = 1.0e-08, tol_gap_rel = 1.0e-08,
  static reg : on, ϵ1 = 1.0e-08, ϵ2 = 4.9e-32
  dynamic reg: on, ϵ = 1.0e-13, δ = 2.0e-07
  iter refine: on, reltol = 1.0e-13, abstol = 1.0e-12,
               max iter = 10, stop ratio = 5.0
  equilibrate: on, min_scale = 1.0e-04, max_scale = 1.0e+04
               max iter = 10

iter    pcost        dcost       gap       pres      dres      k/t        μ       step
---------------------------------------------------------------------------------------------
  0   0.0000e+00  -0.0000e+00  0.00e+00  4.73e-01  5.03e-01  1.00e+00  1.80e+00   ------
  1   0.0000e+00   3.7385e-01  3.74e-01  1.03e-01  8.16e-02  6.35e-01  3.24e-01  8.37e-01
  2   0.0000e+00   1.7155e+01  1.72e+01  2.30e-02  1.02e-02  1.83e+01  5.02e-02  9.71e-01
  3   0.0000e+00  -2.6489e-01  2.65e-01  6.79e-03  5.26e-03  8.93e-02  3.12e-02  5.18e-01
  4   0.0000e+00   6.0742e-03  6.07e-03  5.04e-04  3.93e-04  3.57e-02  2.45e-03  9.23e-01
  5   0.0000e+00   2.2712e-01  2.27e-01  1.53e-04  8.38e-05  2.36e-01  4.68e-04  9.25e-01
  6   0.0000e+00   2.5411e-01  2.54e-01  2.71e-05  2.49e-05  2.59e-01  1.76e-04  8.26e-01
  7   0.0000e+00   6.3020e-02  6.30e-02  2.77e-06  2.37e-06  6.36e-02  1.61e-05  9.22e-01
  8   0.0000e+00   1.4433e-02  1.44e-02  5.99e-07  3.95e-07  1.45e-02  2.38e-06  9.04e-01
  9   0.0000e+00   1.4781e-03  1.48e-03  3.45e-08  2.27e-08  1.48e-03  1.37e-07  9.47e-01
 10   0.0000e+00   1.3987e-05  1.40e-05  1.60e-09  1.11e-09  1.43e-05  6.89e-09  9.65e-01
 11   0.0000e+00   7.8573e-07  7.86e-07  1.60e-10  1.21e-10  8.14e-07  6.34e-10  8.83e-01
 12   0.0000e+00   1.7100e-07  1.71e-07  3.04e-11  9.66e-12  1.74e-07  6.93e-11  9.48e-01
 13   0.0000e+00   1.5429e-07  1.54e-07  9.27e-07  1.18e-11  1.57e-07  2.92e-11  9.87e-02
---------------------------------------------------------------------------------------------
Terminated with status = solved (reduced accuracy)
solve time = 1.86ms
[ Info: Terminated with ALMOST_OPTIMAL (ALMOST_SOLVED) in 0.001863842 seconds.
┌ Warning: * Solver : Clarabel
│
│ * Status
│   Result count       : 1
│   Termination status : ALMOST_OPTIMAL
│   Message from the solver:
│   &quot;ALMOST_SOLVED&quot;
│
│ * Candidate solution (result #1)
│   Primal status      : NEARLY_FEASIBLE_POINT
│   Dual status        : NEARLY_FEASIBLE_POINT
│   Objective value    : -0.00000e+00
│   Dual objective value : -1.71002e-07
│
│ * Work counters
│   Solve time (sec)   : 1.86384e-03
│   Barrier iterations : 13
└ @ MacaulayMatrix ~/.julia/packages/MacaulayMatrix/2RDTD/src/hankel.jl:25</code></pre><p>We find the following PSD hankel</p><pre><code class="language-julia hljs">ν</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MomentMatrix with row/column basis:
 MonomialBasis([1, x, x^2])
And entries in a 3×3 MultivariateMoments.SymMatrix{Float64}:
  1.0000000000000075   3.996902364627232   15.9763030351355
  3.996902364627232   15.9763030351355     63.86432262811344
 15.9763030351355     63.86432262811344   255.31107602137627</code></pre><p>Looking at its singular values, the rank seems to be 1:</p><pre><code class="language-julia hljs">svd(value_matrix(ν)).S</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Float64}:
 272.2861108836006
   0.001268176595828647
   3.684569158988992e-9</code></pre><p>The rank of the truncation is also 1:</p><pre><code class="language-julia hljs">svd(value_matrix(truncate(ν, 1))).S</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 16.976239739447575
  6.329568793473016e-5</code></pre><p>We conclude that the PSD hankel is flat. The root can be obtained using:</p><pre><code class="language-julia hljs">atomic_measure(ν, FixedRank(1))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Atomic measure on the variables x with 1 atoms:
 at [3.99742282946471] with weight 0.9998785045530533</code></pre><p>The solution is also apparent from the equation in the nullspace of the moment matrix:</p><pre><code class="language-julia hljs">nullspace(ν, ShiftNullspace(), FixedRank(1)).polynomials</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{MultivariatePolynomials.VectorPolynomial{Float64, MultivariatePolynomials.Term{Float64, TypedPolynomials.Monomial{(x,), 1}}}}:
 -3.99742282946471 + x</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Index</a><a class="docs-footer-nextpage" href="../dreesen10/">Positive dimensional roots at infinity »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 8 October 2024 06:39">Tuesday 8 October 2024</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
